<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C. Morgan Davis — Data Professional</title>
  <meta name="description" content="Portfolio of C. Morgan Davis, Data Analyst / Scientist / Engineer." />

  <!-- marked.js CDN (Markdown → HTML) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- Site styles -->
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>

  <!-- =============================================
       STICKY NAV
       ============================================= -->
  <nav class="site-nav" aria-label="Site navigation">
    <div class="nav-inner">

      <!-- Brand: avatar + name + contact -->
      <a class="nav-brand" href="index.html" aria-label="C. Morgan Davis — home">
        <img
          class="nav-avatar"
          src="assets/avatar.jpg"
          alt="C. Morgan Davis"
          onerror="this.style.visibility='hidden'"
        />
        <span class="nav-brand-text">
          <span class="nav-name">C. Morgan Davis</span>
          <span class="nav-contact">
            <a href="mailto:cmdavis25@proton.me">cmdavis25@proton.me</a>
          </span>
        </span>
      </a>

      <!-- Hamburger (mobile) -->
      <button
        class="nav-hamburger"
        id="nav-hamburger"
        aria-controls="nav-links"
        aria-expanded="false"
        aria-label="Toggle navigation menu"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>

      <!-- Nav links + icons -->
      <ul class="nav-links" id="nav-links" role="list">
        <li><a href="tel:4157295387" class="nav-phone">415-729-5387</a></li>
        <li><a href="projects.html">Projects</a></li>
        <li>
          <a
            href="resume/Christopher Davis - Data Professional - Call 415-729-5387.pdf"
            class="nav-resume-btn"
            download
          >Resume</a>
        </li>
        <li><a href="bio.html">Bio</a></li>
        <li><a href="blog.html">Blog</a></li>

        <!-- GitHub icon -->
        <li>
          <a
            href="https://github.com/cmdavis25"
            class="nav-icon-link"
            target="_blank"
            rel="noopener"
            aria-label="GitHub profile"
          >
            <!-- GitHub mark SVG (MIT license, GitHub Inc.) -->
            <svg viewBox="0 0 16 16" aria-hidden="true">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
                0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13
                -.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66
                .07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15
                -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27
                .68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12
                .51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48
                0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
          </a>
        </li>

        <!-- LinkedIn icon -->
        <li>
          <a
            href="https://www.linkedin.com/in/c-morgan-davis/"
            class="nav-icon-link"
            target="_blank"
            rel="noopener"
            aria-label="LinkedIn profile"
          >
            <!-- LinkedIn "in" icon -->
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037
                -1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046
                c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337
                7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782
                13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542
                C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729
                C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          </a>
        </li>
      </ul>

    </div>
  </nav>

  <!-- =============================================
       MAIN CONTENT
       ============================================= -->
  <main class="site-main">
    <div class="container">

      <!-- Value Proposition -->
      <section class="page-section" id="value-proposition" aria-labelledby="heading-value">
        <h2 class="section-heading" id="heading-value">Value Proposition</h2>
        <div id="value-proposition-content"></div>
      </section>

      <!-- GitHub Contributions -->
      <section class="page-section" id="github-activity" aria-labelledby="heading-github">
        <h2 class="section-heading" id="heading-github">GitHub Activity</h2>
        <a
          class="gh-chart-wrap"
          href="https://github.com/cmdavis25"
          target="_blank"
          rel="noopener"
          aria-label="View cmdavis25 on GitHub"
        >
          <img
            src="https://ghchart.rshah.org/a0522d/cmdavis25"
            alt="cmdavis25's GitHub contribution chart"
            loading="lazy"
          />
        </a>
      </section>

      <!-- Latest Blog Post (preview) -->
      <section class="page-section" id="latest-post" aria-labelledby="heading-blog">
        <h2 class="section-heading" id="heading-blog">Latest Post</h2>
        <div id="latest-post-content"></div>
      </section>

      <!-- Tech Stack -->
      <section class="page-section" id="tech-stack" aria-labelledby="heading-tech">
        <h2 class="section-heading" id="heading-tech">Tech Stack</h2>
        <div id="tech-stack-content"></div>
      </section>

      <!-- Skills -->
      <section class="page-section" id="skills" aria-labelledby="heading-skills">
        <h2 class="section-heading" id="heading-skills">Skills</h2>
        <div id="skills-content"></div>
      </section>

      <!-- Visualization Gallery -->
      <section class="page-section" id="visualizations" aria-labelledby="heading-viz">
        <h2 class="section-heading" id="heading-viz">Visualizations Gallery</h2>
        <div id="viz-gallery">
          <figure class="viz-item">
            <img src="assets/images/viz/Order_Volume_by_Hour_Line_users.png" alt="Order volume by hour of day — line chart" loading="lazy" />
            <figcaption>Order Volume by Hour of Day</figcaption>
          </figure>
          <figure class="viz-item">
            <img src="assets/images/viz/Basket_Quantity_Frequency_Hist_users.png" alt="Basket quantity frequency — histogram" loading="lazy" />
            <figcaption>Basket Quantity Frequency</figcaption>
          </figure>
          <figure class="viz-item">
            <img src="assets/images/viz/Total_Reorders_Department_Barchart_users.png" alt="Total reorders by department — bar chart" loading="lazy" />
            <figcaption>Total Reorders by Department</figcaption>
          </figure>
          <figure class="viz-item">
            <img src="assets/images/viz/aisle_id_Per_Order_Sums_Pairplot_users.png" alt="Aisle ID per-order sums — pairplot" loading="lazy" />
            <figcaption>Aisle ID Per-Order Sums (Pairplot)</figcaption>
          </figure>
          <figure class="viz-item">
            <img src="assets/images/viz/department_id_Per_Order_Sums_Pairplot_users.png" alt="Department ID per-order sums — pairplot" loading="lazy" />
            <figcaption>Department ID Per-Order Sums (Pairplot)</figcaption>
          </figure>
        </div>
      </section>

    </div>
  </main>

  <!-- Lightbox overlay -->
  <div id="viz-lightbox" role="dialog" aria-modal="true" aria-label="Image viewer">
    <button id="viz-lightbox-close" aria-label="Close image viewer">×</button>
    <img id="viz-lightbox-img" src="" alt="" />
    <div id="viz-lightbox-caption"></div>
  </div>

  <!-- Site JS (shared utilities + nav toggle) -->
  <script src="assets/main.js"></script>

  <script>
    // Render a Markdown section, hoisting its first heading into the section's <h2>.
    async function renderSection(mdUrl, contentEl, headingEl) {
      await renderMarkdown(mdUrl, contentEl);
      if (headingEl) {
        const firstHeading = contentEl.querySelector('h1,h2,h3,h4,h5,h6');
        if (firstHeading) {
          headingEl.textContent = firstHeading.textContent;
          firstHeading.remove();
        }
      }
    }

    // Render homepage Markdown sections
    renderSection('value_proposition.md', document.getElementById('value-proposition-content'), document.getElementById('heading-value'));
    renderMarkdown('tech_stack.md',       document.getElementById('tech-stack-content'));
    renderMarkdown('skills.md',           document.getElementById('skills-content'));

    // Latest blog post preview
    (async () => {
      const el = document.getElementById('latest-post-content');
      const files = await loadIndex('posts.json');
      if (!files.length) {
        el.innerHTML = '<p class="loading-msg">No posts yet.</p>';
        return;
      }
      const url = 'blog_posts/' + files[0];
      try {
        const res = await fetch(url, { cache: 'no-cache' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const text = await res.text();
        const { data, content } = parseFrontMatter(text);

        // Format date as "Month D, YYYY"
        const dateStr = data.date
          ? new Date(data.date + 'T00:00:00').toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
          : '';

        // First 3 non-empty lines of body text
        const previewLines = content.split('\n').filter(l => l.trim()).slice(0, 3).join(' ');

        el.innerHTML = `
          <div class="card">
            <div class="card-title-row">
              <div class="card-title">${data.title || files[0]}</div>
              <div class="card-meta">${dateStr}</div>
            </div>
            <div class="card-summary">${data.summary || ''}</div>
            <button class="accordion-toggle" aria-expanded="false">Read more ▾</button>
            <div class="accordion-body md-content">
              <p>${previewLines}</p>
            </div>
            <a href="blog.html" style="font-family:var(--font-heading);font-size:0.875rem;display:block;margin-top:0.75rem;">
              Read all posts →
            </a>
          </div>`;
      } catch (err) {
        el.innerHTML = `<p class="error-msg">Could not load latest post (${err.message}).</p>`;
      }
    })();
  </script>

  <script>
    // Lightbox for viz gallery
    const lightbox    = document.getElementById('viz-lightbox');
    const lbImg       = document.getElementById('viz-lightbox-img');
    const lbCaption   = document.getElementById('viz-lightbox-caption');
    const lbClose     = document.getElementById('viz-lightbox-close');

    function openLightbox(src, alt, caption) {
      lbImg.src = src;
      lbImg.alt = alt;
      lbCaption.textContent = caption;
      lightbox.classList.add('is-open');
      document.body.style.overflow = 'hidden';
      lbClose.focus();
    }

    function closeLightbox() {
      lightbox.classList.remove('is-open');
      document.body.style.overflow = '';
    }

    document.getElementById('viz-gallery').addEventListener('click', e => {
      const item = e.target.closest('.viz-item');
      if (!item) return;
      const img     = item.querySelector('img');
      const caption = item.querySelector('figcaption');
      openLightbox(img.src, img.alt, caption ? caption.textContent : '');
    });

    lbClose.addEventListener('click', closeLightbox);

    // Click backdrop (not the image) to close
    lightbox.addEventListener('click', e => {
      if (e.target === lightbox) closeLightbox();
    });

    // Escape key to close
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && lightbox.classList.contains('is-open')) closeLightbox();
    });
  </script>

</body>
</html>
